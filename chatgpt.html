<!DOCTYPE html>
<html>
<head>
  <title>Chatbot</title>

  <style>
    /* ========== RESET ========== */
    *{
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: Arial, Helvetica, sans-serif;
    }

    body{
      height: 100vh;
      background: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* ========== APP CONTAINER ========== */
    .app{
      width: 100%;
      max-width: 600px;
      height: 85vh;

      background: #ffffff;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.25);

      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* ========== MESSAGE AREA ========== */
    .messages{
      flex: 1;
      overflow-y: auto;

      padding: 18px;
      background: #f5f6f8;

      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    /* ========== MESSAGE ROW ========== */
    .message-row{
      display: flex;
      align-items: flex-end;
      gap: 8px;
      max-width: 80%;
    }

    .message-row.user{
      align-self: flex-end;
      flex-direction: row-reverse;
    }

    .message-row.robot{
      align-self: flex-start;
    }

    /* ========== BUBBLE ========== */
    .bubble{
      padding: 10px 14px;
      border-radius: 18px;
      font-size: 14px;
      line-height: 1.4;
    }

    .user .bubble{
      background: #017509;
      color: white;
    }

    .robot .bubble{
      background: #e4e6eb;
      color: #111;
    }

    /* avatar */
    .avatar{
      width: 34px;
      height: 34px;
    }

    /* ========== INPUT SECTION ========== */
    .input-area{
      display: flex;
      padding: 12px;
      border-top: 1px solid #ddd;
      background: white;
    }

    .text-input{
      flex: 1;
      padding: 12px 16px;
      border-radius: 50px 0 0 50px;
      border: 1px solid #ccc;
      outline: none;
      font-size: 14px;
    }

    .send-btn{
      padding: 12px 22px;
      border: none;
      border-radius: 0 50px 50px 0;

      background: #017509;
      color: white;
      font-weight: bold;

      cursor: pointer;
      transition: 0.2s;
    }

    .send-btn:hover{
      background: #025d0a;
      transform: scale(1.04);
    }

    /* scrollbar */
    .messages::-webkit-scrollbar{
      width: 6px;
    }
    .messages::-webkit-scrollbar-thumb{
      background: #bbb;
      border-radius: 10px;
    }

  </style>
</head>

<body>

  <div class="js-container"></div>

  <script src="react-basics.js"></script>
  <script src="https://unpkg.com/supersimpledev/react.js"></script>
  <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>
  <script src="https://unpkg.com/supersimpledev/chatbot.js"></script>
  <script src="https://unpkg.com/supersimpledev/babel.js"></script>

  <script type="text/babel">

    /* ================= INPUT ================= */
    function ChatInput({ chatMessages, setChatMessages }) {

      const [inputText, setInputText] = React.useState('');

      function sendMessage(){
        if(!inputText.trim()) return;

        const newMessages = [
          ...chatMessages,
          {
            message: inputText,
            sender: 'user',
            id: crypto.randomUUID()
          }
        ];

        setChatMessages(newMessages);

        const response = Chatbot.getResponse(inputText);

        setChatMessages([
          ...newMessages,
          {
            message: response,
            sender: 'robot',
            id: crypto.randomUUID()
          }
        ]);

        setInputText('');
      }

      function handleEnter(e){
        if(e.key === 'Enter') sendMessage();
      }

      return(
        <div className="input-area">
          <input
            className="text-input"
            placeholder="Send a message..."
            value={inputText}
            onChange={(e)=>setInputText(e.target.value)}
            onKeyDown={handleEnter}
          />

          <button className="send-btn" onClick={sendMessage}>
            Send
          </button>
        </div>
      );
    }


    /* ================= SINGLE MESSAGE ================= */
    function ChatMessage({ message, sender }) {

      return(
        <div className={`message-row ${sender}`}>
          <img
            className="avatar"
            src={sender === 'robot' ? 'robot.png' : 'user.png'}
          />

          <div className="bubble">
            {message}
          </div>
        </div>
      );
    }


    /* ================= MESSAGE LIST ================= */
    function ChatMessages({ chatMessages }) {

      return(
        <div className="messages">
          {chatMessages.map((msg) => (
            <ChatMessage
              key={msg.id}
              message={msg.message}
              sender={msg.sender}
            />
          ))}
        </div>
      );
    }


    /* ================= APP ================= */
    function App(){

      const [chatMessages , setChatMessages] = React.useState([
        {message:'hello chatbot', sender:'user', id:'1'},
        {message:'Hello! How can I help you?', sender:'robot', id:'2'}
      ]);

      return(
        <div className="app">
          <ChatMessages chatMessages={chatMessages} />
          <ChatInput
            chatMessages={chatMessages}
            setChatMessages={setChatMessages}
          />
        </div>
      );
    }

    const container = document.querySelector('.js-container');
    ReactDOM.createRoot(container).render(<App />);

  </script>

</body>
</html>
